{"ts":1350339060780,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1350339175072,"patch":[[{"diffs":[[1,"#!/bin/sh\r\n\r\nADDRESS=localhost:3131\r\nDIRNAME=/var/www/appgis.com/www/pgstudio/\r\nCONFIG=tilestache.cfg\r\nWORKERS=8\r\n\r\nPIDFILE=\"/var/run/tilefarm-gunicorn.pid\"\r\nLOGFILE=\"/var/log/tilefarm-gunicorn.log\"\r\nCOMMAND=\"$GUNICORN --daemon --user www-data --workers $WORKERS --worker-class egg:gunicorn#gevent_wsgi --bind $ADDRESS --log-file $LOGFILE\"\r\n\r\nstart_server () {\r\n  if [ -f $PIDFILE ]; then\r\n    #pid exists, check if running\r\n    if [ \"$(ps -p `cat $PIDFILE` | wc -l)\" -gt 1 ]; then\r\n       echo \"Server already running on ${ADDRESS}\"\r\n       return\r\n    fi\r\n  fi\r\n  echo \"starting ${ADDRESS}\"\r\n  cd $DIRNAME && $COMMAND --pid $PIDFILE \"TileStache:WSGITileServer('tilestache.cfg')\"\r\n}\r\n\r\nstop_server () {\r\n  if [ -f $PIDFILE ] && [ \"$(ps -p `cat $PIDFILE` | wc -l)\" -gt 1 ]; then\r\n    echo \"stopping server ${ADDRESS}\"\r\n    kill -9 `cat $PIDFILE`\r\n    rm $PIDFILE\r\n  else\r\n    if [ -f $PIDFILE ]; then\r\n      echo \"server ${ADDRESS} not running\"\r\n    else\r\n      echo \"No pid file found for server ${ADDRESS}\"\r\n    fi\r\n  fi\r\n}\r\n\r\nrestart_server () {\r\n  if [ -f $PIDFILE ] && [ \"$(ps -p `cat $PIDFILE` | wc -l)\" -gt 1 ]; then\r\n    echo \"gracefully restarting server ${ADDRESS}\"\r\n    kill -HUP `cat $PIDFILE`\r\n  else\r\n    if [ -f $PIDFILE ]; then\r\n      echo \"server ${ADDRESS} not running\"\r\n    else\r\n      echo \"No pid file found for server ${ADDRESS}\"\r\n    fi\r\n  fi\r\n}\r\n\r\ncase \"$1\" in\r\n'start')\r\n  start_server\r\n  ;;\r\n'stop')\r\n  stop_server\r\n  ;;\r\n'restart')\r\n  restart_server\r\n  ;;\r\n*)\r\n  echo \"Usage: $0 { start | stop | restart }\"\r\n  ;;\r\nesac\r\n\r\nexit 0"]],"start1":0,"start2":0,"length1":0,"length2":1555}]],"length":1555,"saved":false}
{"ts":1350339362882,"patch":[[{"diffs":[[0,"io/\r"],[-1,"\nCONFIG=tilestache.cfg\r\nWORKERS=8\r"],[0,"\n\r\nP"]],"start1":75,"start2":75,"length1":42,"length2":8},{"diffs":[[0,"var/run/"],[-1,"tilefarm-gunicorn"],[1,"pgstudio"],[0,".pid\"\r\nL"]],"start1":92,"start2":92,"length1":33,"length2":24},{"diffs":[[0,"log/"],[-1,"tilefarm-gunicorn.log\"\r\nCOMMAND=\"$GUNICORN --daemon --user www-data --workers $WORKERS --worker-class egg:gunicorn#gevent_wsgi --bind $ADDRESS --log-file $LOGFILE"],[1,"pgstudio/pgstudio.log\"\r\nCOMMAND=\"$node "],[0,"\"\r\n\r"]],"start1":129,"start2":129,"length1":170,"length2":47}]],"length":1389,"saved":false}
{"ts":1350340283796,"patch":[[{"diffs":[[0,"\r\n\r\n"],[-1,"ADDRESS=localhost:3131"],[1,"description \"Start pgstudio aplication\"\r\nstart on runlevel [2345]\r\nstop on runlevel [06]\r\nrespawn\r\nrespawn limit 10 5\r\n"],[0,"\r\nDI"]],"start1":9,"start2":9,"length1":30,"length2":127},{"diffs":[[0,"studio/\r"],[1,"\nAPPNAME=server.js\r"],[0,"\n\r\nPIDFI"]],"start1":168,"start2":168,"length1":16,"length2":35},{"diffs":[[0,"o.log\"\r\n"],[1,"\r\n"],[0,"COMMAND="]],"start1":265,"start2":265,"length1":16,"length2":18},{"diffs":[[0,"ND=\""],[-1,"$node "],[1,"exec node $DIRNAME $APPNAME"],[0,"\"\r\n\r"]],"start1":280,"start2":280,"length1":14,"length2":35},{"diffs":[[0,"  if [ \"$(ps -p "],[-1,"`"],[1,"'"],[0,"cat $PIDFILE` | "]],"start1":400,"start2":400,"length1":33,"length2":33},{"diffs":[[0,"-p 'cat $PIDFILE"],[-1,"`"],[1,"'"],[0," | wc -l)\" -gt 1"]],"start1":413,"start2":413,"length1":33,"length2":33},{"diffs":[[0,"ning"],[-1," on ${ADDRESS}"],[0,"\"\r\n "]],"start1":487,"start2":487,"length1":22,"length2":8},{"diffs":[[0,"ting"],[-1," ${ADDRESS}\"\r\n  cd $DIRNAME && $COMMAND --pid $PIDFILE \"TileStache:WSGITileServer('tilestache.cfg')\""],[1,"...\"\r\n  $COMMAND --pid $PIDFILE"],[0,"\r\n}\r"]],"start1":535,"start2":535,"length1":108,"length2":39}]],"length":1445,"saved":false}
{"ts":1350340300738,"patch":[[{"diffs":[[0,"] && [ \"$(ps -p "],[-1,"`"],[1,"'"],[0,"cat $PIDFILE` | "]],"start1":614,"start2":614,"length1":33,"length2":33},{"diffs":[[0,"-p 'cat $PIDFILE"],[-1,"`"],[1,"'"],[0," | wc -l)\" -gt 1"]],"start1":627,"start2":627,"length1":33,"length2":33},{"diffs":[[0,"pping server"],[-1," ${ADDRESS}"],[1,".."],[0,"\"\r\n    kill "]],"start1":683,"start2":683,"length1":35,"length2":26}]],"length":1436,"saved":false}
{"ts":1350340352583,"patch":[[{"diffs":[[0,"ho \""],[-1,"Server"],[1,"pgstudio"],[0," alr"]],"start1":465,"start2":465,"length1":14,"length2":16},{"diffs":[[0,"starting"],[-1,""],[0,""],[1," pgstudio"],[0,"...\"\r\n  "]],"start1":533,"start2":533,"length1":16,"length2":25},{"diffs":[[0,"topping "],[-1,"server"],[1,"pgstudio."],[0,"..\"\r\n   "]],"start1":692,"start2":692,"length1":22,"length2":25},{"diffs":[[0,"kill -9 "],[-1,"`"],[1,"'"],[0,"cat $PID"]],"start1":718,"start2":718,"length1":17,"length2":17},{"diffs":[[0,"cat $PIDFILE"],[-1,"`"],[1,"'"],[0,"\r\n    rm $PI"]],"start1":727,"start2":727,"length1":25,"length2":25},{"diffs":[[0,"  echo \""],[-1,"server ${ADDRESS}"],[1,"pgstudio"],[0," not run"]],"start1":801,"start2":801,"length1":33,"length2":24},{"diffs":[[0,"und for "],[-1,"server ${ADDRESS}"],[1,"pgstudio"],[0,"\"\r\n    f"]],"start1":868,"start2":868,"length1":33,"length2":24}]],"length":1432,"saved":false}
{"ts":1350340415353,"patch":[[{"diffs":[[0,"$(ps -p "],[-1,"`"],[1,"'"],[0,"cat $PID"]],"start1":954,"start2":954,"length1":17,"length2":17},{"diffs":[[0,"$PIDFILE"],[-1,"`"],[1,"'"],[0," | wc -l"]],"start1":967,"start2":967,"length1":17,"length2":17},{"diffs":[[0,"tarting "],[-1,"server ${ADDRESS}"],[1,"pgstudio"],[0,"\"\r\n    k"]],"start1":1026,"start2":1026,"length1":33,"length2":24},{"diffs":[[0,"  echo \""],[-1,"server ${ADDRESS}"],[1,"pgstudio"],[0," not run"]],"start1":1117,"start2":1117,"length1":33,"length2":24},{"diffs":[[0,"for "],[-1,"server ${ADDRESS}"],[1,"pgstudio"],[0,"\"\r\n "]],"start1":1188,"start2":1188,"length1":25,"length2":16}]],"length":1405,"saved":false}
{"ts":1350340511160,"patch":[[{"diffs":[[-1,"#!/bin/sh\r\n"],[0,"\r\nde"]],"start1":0,"start2":0,"length1":15,"length2":4}]],"length":1394,"saved":false}
{"contributors":[],"silentsave":false,"ts":1350340769875,"patch":[[{"diffs":[[0,"ation\"\r\n"],[1,"\r\n"],[0,"start on"]],"start1":35,"start2":35,"length1":16,"length2":18},{"diffs":[[0," on "],[-1,"runlevel [2345]\r\nstop on runlevel [06]\r\nrespawn\r\nrespawn limit 10 5"],[1,"(local-filesystems and net-device-up IFACE=eth0)\r\nstop on shutdown\r\n\r\nrespawn\r\n\r\nexec sudo -u node sh -c \\\"/usr/local/bin/node /var/www/appgis.com/www/pgstudio/server.js >> /var/log/pgstudio/pgstudio.log 2>&1\\\"\r\n"],[0,"\r\n\r\n"]],"start1":50,"start2":50,"length1":75,"length2":220}]],"length":1541,"saved":false}
{"ts":1350340784262,"patch":[[{"diffs":[[0,"\r\n\r\n"],[-1,"\r\nDIRNAME=/var/www/appgis.com/www/pgstudio/\r\nAPPNAME=server.js\r\n\r\nPIDFILE=\"/var/run/pgstudio.pid\"\r\nLOGFILE=\"/var/log/pgstudio/pgstudio.log\"\r\n\r\nCOMMAND=\"exec node $DIRNAME $APPNAME\"\r\n\r\nstart_server () {\r\n  if [ -f $PIDFILE ]; then\r\n    #pid exists, check if running\r\n    if [ \"$(ps -p 'cat $PIDFILE' | wc -l)\" -gt 1 ]; then\r\n       echo \"pgstudio already running\"\r\n       return\r\n    fi\r\n  fi\r\n  echo \"starting pgstudio...\"\r\n  $COMMAND --pid $PIDFILE\r\n}\r\n\r\nstop_server () {\r\n  if [ -f $PIDFILE ] && [ \"$(ps -p 'cat $PIDFILE' | wc -l)\" -gt 1 ]; then\r\n    echo \"stopping pgstudio...\"\r\n    kill -9 'cat $PIDFILE'\r\n    rm $PIDFILE\r\n  else\r\n    if [ -f $PIDFILE ]; then\r\n      echo \"pgstudio not running\"\r\n    else\r\n      echo \"No pid file found for pgstudio\"\r\n    fi\r\n  fi\r\n}\r\n\r\nrestart_server () {\r\n  if [ -f $PIDFILE ] && [ \"$(ps -p 'cat $PIDFILE' | wc -l)\" -gt 1 ]; then\r\n    echo \"gracefully restarting pgstudio\"\r\n    kill -HUP `cat $PIDFILE`\r\n  else\r\n    if [ -f $PIDFILE ]; then\r\n      echo \"pgstudio not running\"\r\n    else\r\n      echo \"No pid file found for pgstudio\"\r\n    fi\r\n  fi\r\n}\r\n\r\ncase \"$1\" in\r\n'start')\r\n  start_server\r\n  ;;\r\n'stop')\r\n  stop_server\r\n  ;;\r\n'restart')\r\n  restart_server\r\n  ;;\r\n*)\r\n  echo \"Usage: $0 { start | stop | restart }\"\r\n  ;;\r\nesac\r\n\r\nexit 0"]],"start1":264,"start2":264,"length1":1277,"length2":4}]],"length":268,"saved":false}
{"ts":1350341289915,"patch":[[{"diffs":[[0,"\r\n\r\n"],[-1,"exec sudo -u node sh -c \\\"/usr/local/bin/node"],[1,"script\r\n    cd"],[0," /va"]],"start1":131,"start2":131,"length1":53,"length2":22},{"diffs":[[0,"gstudio/"],[1,"\r\n    exec node "],[0,"server.j"]],"start1":175,"start2":175,"length1":16,"length2":32},{"diffs":[[0,"rver.js "],[1,"2>&1 "],[0,">> /var/"]],"start1":201,"start2":201,"length1":16,"length2":21},{"diffs":[[0,".log"],[-1," 2>&1\\\""],[1,"\r\nend script"],[0,"\r\n\r\n"]],"start1":243,"start2":243,"length1":15,"length2":20}]],"length":263,"saved":false}
